<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Standings – El7amla</title>
  <link rel="icon" href="./assets/favicon.ico">
  <link rel="stylesheet" href="./assets/site.css">
</head>
<body>
  <header>
    <div class="container" style="display:flex; align-items:center; justify-content:space-between; gap:16px;">
      <a href="./" style="display:flex; align-items:center; gap:10px; text-decoration:none;">
        <img src="./el7amla_logo.png" alt="El7amla" width="36" height="36" style="border-radius:12px; object-fit:cover;">
        <strong>El7amla League</strong>
      </a>
      <nav>
        <a href="./">Home</a>
        <a href="./fixtures.html">Fixtures</a>
        <a href="./standings.html" aria-current="page">Standings</a>
        <a href="./teams.html">Teams</a>
      </nav>
    </div>
  </header>

  <main>
    <h1>Standings</h1>
    <div class="card">
      <h3>Teams Ranking</h3>
      <div id="teamsTable"></div>
    </div>
    <div class="card" style="margin-top:16px">
      <h3>Players Ranking</h3>
      <div id="playersTable"></div>
    </div>
    <p id="standingsError" style="display:none;color:#b00020;margin-top:8px"></p>
  </main>

  <footer>
    <div class="container footer-inner">
      <span class="small">© <span id="year"></span> El7amla League</span>
      <a class="small" href="https://github.com/El7amla/El7amla_Website" target="_blank" rel="noreferrer">GitHub</a>
    </div>
  </footer>

  <script type="module">
    document.querySelector('#year').textContent = new Date().getFullYear();

    async function loadJSON(url){
      const r = await fetch(url, { cache: "no-store" });
      if(!r.ok) throw new Error(`Fetch failed: ${r.status}`);
      return r.json();
    }
    function renderTable(el, rows, columns){
      el.innerHTML = `<table>
        <thead><tr>${columns.map(c=>`<th>${c.header}</th>`).join('')}</tr></thead>
        <tbody>${rows.map(r=>`<tr>${columns.map(c=>`<td>${(r[c.key] ?? "")}</td>`).join('')}</tr>`).join('')}</tbody>
      </table>`;
    }

    const err = document.getElementById('standingsError');
    try{
      const data = await loadJSON('./data/standings.json');
      renderTable(document.getElementById('teamsTable'), data.teams, [
        { header:'Rank', key:'rank' }, { header:'Team', key:'team' }, { header:'Points', key:'points' }
      ]);
      renderTable(document.getElementById('playersTable'), data.players, [
        { header:'Rank', key:'rank' }, { header:'Player', key:'player' }, { header:'Team', key:'team' }, { header:'Points', key:'points' }
      ]);
      err.style.display = 'none';
    }catch(e){
      console.error(e);
      err.textContent = 'Could not load standings. Check ./data/standings.json';
      err.style.display = 'block';
    }
  </script>
</body>
</html>
